FROM golang:1.12-alpine as build

WORKDIR /app

COPY /app /app

RUN apk update && \
    apk add --no-cache git && \
    go get github.com/go-sql-driver/mysql && \
    go get github.com/gin-gonic/gin && \
    go get github.com/jinzhu/gorm && \
    go get github.com/gin-contrib/cors
    
FROM alpine

WORKDIR /app

COPY --from=build /app .

RUN addgroup go \
    && adduser -D -G go go \
    && chown -R go:go /app

CMD ["./app"]